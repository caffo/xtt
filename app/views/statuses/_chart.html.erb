<% params[:filter] = params.key?(:filter) ? params[:filter].to_sym : :weekly -%>
<% if Status.filter_types.include?(params[:filter]) -%>
	<% unless params[:filter] == :daily -%>
	<% chart_labels = chart_labels_for(params[:filter], date_range) -%>
  
  <% unless hours.empty? %>
  <% chart_data = chart_data_for(chart_labels, params[:filter], hours) %>
  
	  <% if params[:filter] == :monthly %>
	  
	    <%= image_tag(Gchart.line(
	       :encoding => 'text',
         :bg => 'CACACA', 
         :data => chart_data,
         :max_value => normalized_max(chart_data),
         :line_colors => ['224499'],
         :size => '380x140',
         :custom => "&amp;chm=B,4E77DD,0,0,0&amp;chg=0,25,1,0&amp;chbh=40&amp;chxr=0,1,#{date_range.last.day}",            
         :axis_with_labels => %w(x y)), :style => 'margin-top:27px', :id => "#{params[:filter]}-chart", :class => 'special-chart') %>
	
	  <% elsif [:weekly, :'bi-weekly'].include?(params[:filter]) %>
	  <%= image_tag(Gchart.line(
	     :encoding => 'simple',
       :bg => 'CACACA', 
       :max_value => normalized_max(chart_data),
       :data => chart_data,
       :line_colors => ['224499'],
       :size => '380x140',
       :custom => "&amp;chm=B,4E77DD,0,0,0&amp;chg=0,25,1,0&amp;chbh=40&amp;chxr=0,#{date_range.first.day},#{date_range.last.day}|1,0,#{normalized_max(chart_data).to_i}",            
       :axis_with_labels => %w(x y)), :style => 'margin-top:27px', :id => "#{params[:filter]}-chart", :class => 'special-chart') %>
    
    <% else %>
    
      <%= image_tag(Gchart.bar(
         :bg => 'CACACA', 
         :data => chart_data_for(chart_labels, params[:filter], hours),
         :line_colors => ['224499'],
         :max_value => 'auto',
         :bar_width => '100',
         :size => '380x120',
         :custom => "chxr=1,0,24&amp;chg=0,25,1,0&amp;chbh=40",            
         :axis_labels => [chart_labels * "|"],
         :axis_with_labels => %w(x y)), :style => 'margin-top:27px', :id => "#{params[:filter]}-chart", :class => 'special-chart') %>
    <% end %>
  <% end -%>
  <% end %>
  <p class="special-num">
    <span class="main-num"><%= number_with_precision hours.total, '2' %></span>
    <span class="quiet">
      <%= period_to_sentence(params[:filter], date_range, hours.total) %>
    </span>
    <%= paging_for_period(date_range) %>
  </p>
<% else -%>
	<p>Invalid filter: <%=h params[:filter] %></p>
<% end -%>